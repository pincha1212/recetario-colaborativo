<div class="form-container">
  <h2>{{ editando ? '九勇 Editar Receta' : '游꼽 Nueva Receta' }}</h2>

  <form [formGroup]="form" (ngSubmit)="guardarReceta()">
    <!-- Secci칩n de t칤tulo y descripci칩n -->
    <div class="form-group">
      <label>T칤tulo</label>
      <input type="text" formControlName="title">
      <div *ngIf="form.get('title')?.errors" class="error-message">
        <span *ngIf="form.get('title')?.hasError('required')">Campo requerido</span>
        <span *ngIf="form.get('title')?.hasError('minlength')">M칤nimo 3 caracteres</span>
      </div>
    </div>
    <div class="form-group">
      <label>Descripci칩n</label>
      <textarea formControlName="description" rows="3" placeholder="Breve descripci칩n de la receta"></textarea>
    </div>

    <!-- Secci칩n de ingredientes y pasos -->
    <div class="columns">
      <div class="form-group">
        <label>Ingredientes</label>
        <textarea formControlName="ingredients" rows="6"
          placeholder="Separados por comas:&#10;- Arroz&#10;- Azafr치n&#10;- Mariscos"></textarea>
      </div>

      <div class="form-group">
        <label>Pasos de preparaci칩n</label>
        <textarea formControlName="steps" rows="6"
          placeholder="Uno por l칤nea:&#10;1. Calentar el agua&#10;2. A침adir arroz"></textarea>
      </div>
    </div>

    <!-- Secci칩n de categor칤as actualizada -->
    <section class="filters-section">
      <div class="filters-header">
        <h3 class="filter-title">Categor칤as</h3>

        <!-- Input de b칰squeda/creaci칩n -->
        <div class="add-category">
          <input type="text" [(ngModel)]="newCategory" [ngModelOptions]="{standalone: true}"
            placeholder="Buscar o crear categor칤a" (keyup)="onCategorySearch()" (keyup.enter)="addNewCategory()" />
          <button type="button" class="add-btn" (click)="addNewCategory()">+</button>

          <!-- Sugerencias de b칰squeda -->
          <div class="suggestions-box" *ngIf="filteredCategories.length > 0">
            <div class="suggestions-container">
              <div *ngFor="let cat of filteredCategories" class="suggestion-item">
                {{ cat }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tags de categor칤as seleccionadas (se mantiene igual) -->
      <div class="selected-categories" *ngIf="selectedCategories.length > 0">
        <span class="selected-tag" *ngFor="let cat of selectedCategories">
          {{ cat }}
          <span class="remove-tag" (click)="toggleCategory(cat)">&times;</span>
        </span>
      </div>

      <!-- Grid din치mico -->
      <div class="categories-panel" [class.active]="contextualCategories.length > 0">
        <div class="categories-grid">
          <button *ngFor="let cat of contextualCategories" class="category-btn" (click)="toggleCategory(cat)">
            {{ cat }}
          </button>
        </div>
      </div>
    </section>

    <!-- Botones de acci칩n -->
    <div class="form-actions">
      <button type="submit" class="submit-btn">
        {{ editando ? 'Actualizar Receta' : 'Guardar Receta' }}
      </button>
      <button type="button" class="cancel-btn" (click)="volver()">
        Cancelar
      </button>
    </div>
  </form>
</div>